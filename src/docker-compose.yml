version: '3'

services:
  db:
    build:
      context: ./requirements/mariadb
      args:
        - MYSQL_USER
        - MYSQL_ROOT_PASSWORD
    container_name: db
    restart: unless-stopped
    # env_file:
    #   - .env
    networks:
      - myNetwork
  wordpress:
    depends_on:
      - db
    build: ./requirements/wordpress
    container_name: wp
    restart: unless-stopped
    volumes:
      - WordPress:/var/www/html/wordpress
    networks:
      - myNetwork
    env_file:
      - .env
    init : true
  websrv:
    depends_on:
      - wordpress
    build: ./requirements/nginx
    container_name: nginx
    restart: unless-stopped
    env_file:
      - .env
    ports:
     - "443:443"
    volumes:
      - WordPress:/var/www/html/wordpress
    networks:
      - myNetwork

volumes:
  WordPress:
  WordPressDB:

networks:
  myNetwork:
    driver: bridge